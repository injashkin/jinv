---
title: Информационная безопасность с HelmetJS
date: 2020-04-16
---

Перевод https://helmetjs.github.io/docs/ и https://www.freecodecamp.org/learn/information-security-and-quality-assurance/information-security-with-helmetjs/

## Установка и подключение Helmet

Helmet поможет вам защитить ваши Express приложения, установив различные HTTP заголовки.

Установите пакет Helmet:

```
$ npm install helmet
```

Затем используйте его в своем коде:

```js
var helmet = require('helmet');
app.use(helmet());
```

## Скрытие потенциально опасной информации с помощью `helmet.hidePoweredBy()`

Хакеры могут использовать известные уязвимости в Express/Node, если они видят, что ваш сайт работает на Express. На каждый клиентский запрос Express отправляет ответ, в котором, по умолчанию, присутствует HTTP заголовок `X-Powered-By: Express`. Промежуточный обработчик `helmet.hidePoweredBy()` удаляет заголовок X-Powered-By. 

```js
var helmet = require('helmet');
app.use(helmet.hidePoweredBy());
```

Вы также можете явно установить заголовок на что-то другое, чтобы сбить людей с толку, например, 

```js
var helmet = require('helmet');
app.use(helmet.hidePoweredBy({ setTo: 'PHP 4.2.0' }));
```

## Уменьшите риск взлома с помощью `helmet.frameguard()`

Ваша страница может быть помещена в `<frame>` или `<iframe>` без вашего согласия. Это может привести, в частности, к кликджекинг атакам. Clickjacking - это метод обмана пользователя, заставляющий его взаимодействовать со страницей, отличной от той, которую он видит. Этого можно добиться, запустив вашу страницу с вредоносным содержимым, с помощью iframing. В этом содержимом хакер может наложить на вашу страницу скрытый слой. Скрытые кнопки могут быть использованы для запуска плохих сценариев. 

Чтобы браузер не помещал вашу веб-страницу в iframe нужно послать ему заголовок X-Frame-Options. Когда браузеры загружают iframes, они проверяют значение заголовка X-Frame-Options и прерывают загрузку, если это не разрешено.

Заголовок имеет три варианта:

`X-Frame-Options: DENY` не позволит никому помещать эту страницу в iframe.
`X-Frame-Options: SAMEORIGIN` только вы можете поместить свои собственные страницы в iframes, и никто другой .
`X-Frame-Options: ALLOW-FROM http://example.com` позволит только сайту http://example.com поместить вашу страницу в iframe, и никому больше. (Параметр ALLOW-FROM заголовка не поддерживается во многих браузерах. Эти браузеры будут игнорировать весь заголовок, и фрейм будет отображаться, поэтому вам следует избегать использования этой опции.)

В Helmet есть промежуточный обработчик `helmet.frameguard()`, который устанавливает заголовок X-Frame-Options.

Обработчик можно использовать как часть Helmet:

```js
var helmet = require('helmet');
app.use(helmet.frameguard({ action: 'sameorigin' }))
```

Можно, также, использовать его в качестве автономного модуля:

```js
//Убедитесь, что вы запустили "npm install frameguard", чтобы получить пакет Frameguard.
const frameguard = require('frameguard')

app.use(frameguard({ action: 'deny' }))
```

## Уменьшение риска межсайтовых скриптовых атак (XSS) с помощью `helmet.xssFilter()`

Межсайтовые скриптинг (XSS) - это частый тип атак, когда вредоносные скрипты вводятся на уязвимые страницы с целью кражи конфиденциальных данных, таких как сеансовые cookie или пароли. Цель атаки XSS - получить контроль над JavaScript в браузере жертвы. После того, как хакер сделал это, есть много неприятных вещей, которые он может сделать: регистрировать ваши действия, выдавать себя за вас, красть ваши аутентификационные файлы cookie и многое другое.

Один из видов XSS называется "Reflected XSS". Как правило, он работает, устанавливая строку запроса, которая помещается непосредственно в HTML. Включение JavaScript в строку запроса может позволить злоумышленнику выполнить свой JavaScript, просто предоставив кому-то вредоносную строку запроса.

Основное правило для снижения риска XSS атак очень простое: "никогда не доверяйте вводу пользователя". Как разработчик вы всегда должны очищать все входные данные, поступающие извне. Это включает в себя данные, поступающие из форм, URL-адреса запросов GET и даже из тел сообщений. Очистка означает, что вы должны найти и закодировать символы, которые могут быть опасны, например <,>.

Современные браузеры могут помочь снизить риск, приняв более эффективные стратегии программного обеспечения. Часто они настраиваются с помощью HTTP-заголовков.

HTTP-заголовок X-XSS-Protection является базовой защитой. Браузер обнаруживает потенциальный введенный сценарий с помощью эвристического фильтра. Если заголовок включен, браузер изменяет код скрипта, нейтрализуя его.

```js
// Убедитесь, что вы установили пакет Helmet с помощью "npm install helmet".
const helmet = require('helmet')

// Устанавливает "X-XSS-Protection: 1; mode=block".
app.use(helmet.xssFilter())
```

Более подробно о helmet.xssFilter() читайте [здесь](https://helmetjs.github.io/docs/xss-filter/).

## Не позволять клиенту угатывать в ответе тип MIME с помощью `helmet.noSniff()`

Браузеры могут использовать контент-сниффинг или MIME-сниффинг для адаптации к различным типам данных, поступающих из ответа. Они переопределяют заголовки типа контента, чтобы угадать и обработать данные. Хотя это может быть удобно в некоторых сценариях, это также может привести к некоторым опасным атакам. 


Это промежуточное программное обеспечение устанавливает заголовок X-Content-Type-Options в nosniff. Это дает браузеру указание не обходить указанный тип контента.
Короче говоря: промежуточное программное обеспечение Don't Sniff Mimetype, noSniff, помогает предотвратить попытки браузеров угадать (”нюхать") тип MIME, что может иметь последствия для безопасности. Он делает это, установив заголовок X-Content-Type-Options в nosniff.